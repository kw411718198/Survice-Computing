# 作业报告1

------

院系：数据科学与计算机学院
年纪专业：2017级软件工程
姓名：孔伟
学号：17343055
日期：2019年9月1日

------

## 【实验题目】

- 让你的计算机也能提供云桌面服务

## 【实验目的】

1. 初步了解虚拟化技术，理解云计算的相关概念
2. 理解系统工程师面临的困境
3. 理解自动化安装、管理（DevOps）在云应用中的重要性

## 【实验环境与要求】

- 用户通过互联网，使用微软远程桌面，远程访问你在PC机上创建的虚拟机

- 虚拟机操作系统 Centos，Ubuntu，或 你喜欢的 Linux 发行版，能使用 NAT 访问外网。

## 【实验内容】

1. 安装 VirtualBox

   + 安装 Git 客户端（git bash），下载地址：官网，或 gitfor windows 或 github desktop

     ![git安装成功](/image/git安装成功.PNG)

   + 安装 Oracle VirtualBox 5.X，官方下载

     ![安装virtualbox](/image/安装virtualbox.PNG)

     因为之前的课程使用过Git，因此省略的这两个步骤。

   + 配置 VirtualBox 虚拟机存储位置，避免找不到虚拟机存储位置，特别是消耗启动盘的宝贵空间

     + VirtualBox菜单 ：管理 -> 全局设定，常规页面

       ![viutualdisk](/image/viutualdisk.PNG)

   + 创建虚拟机内部虚拟网络，使得 Vbox 内部虚拟机可以通过它，实现虚拟机之间、虚拟机与主机的通讯

     + VirtualBox菜单 ：管理 -> 主机网络管理器，创建一块虚拟网卡，网址分配：192.168.100.1/24

       因为默认有一块虚拟网卡，因此直接使用了，修改了一下地址为<u>192.168.100.1</u>。

       ![vb网卡配置](/image/vb网卡配置.PNG)

     + 在主机 windows 命令行窗口输入 ipconfig 就可以看到 VirtualBox Host-Only Network #?: 的网卡

       ![ipconfig](/image/ipconfig.PNG)

       如图，网卡的IP地址为<u>192.168.100.1</u>，与设定符合。

2. 创建Linux虚拟机（以 CentoOS 为案例）

   + 下载 Linux 发行版镜像。

     + 如果是 Centos，仅需要 Minimal ISO；如果是 Ubuntu 请下载桌面和服务器
     + 阿里云OPSX 下载

   + 用 VBox 创建虚拟机。 虚拟机名称建议以 centos-xxx 或 ub-xxx 命名，如果向导不能创建 64 bit 虚拟机，请更换电脑!!!

     + 建议虚拟机CPU、内存采用默认。如果是桌面版，CPU建议数1-2，内存不低于2G

       ![创建虚拟机](/image/创建虚拟机.PNG)

       ![创建2](/image/创建2.PNG)

     + 显示，显存采用默认。如果是桌面版，显存越大越好

     + 存储，不低于30G。避免以后扩展难。

       ![创建3](/image/创建3.PNG)

       ![创建4](/image/创建4.PNG)

       我这里设置了4G的内存，存储选择了35G，其余均选择默认。

       

     + 网络，第一块网卡必须是 NAT；第二块网卡连接方式： Host-Only，启用网络连接，接口就是前面创建的虚拟网卡

       网卡1如下：

       ![网卡1](/image/网卡1.PNG)

       网卡2如下：

       ![网卡2](/image/网卡2.PNG)

   + 安装 Base 虚拟机，例如 centos-base。 利用虚拟化软件提供的虚拟机复制功能，避免每次安装 OS 系统的痛苦

     + 第一次安装时会进行启动盘的选择

       ![启动盘选择](/image/启动盘选择.PNG)

     + 配置环节，需要选择安装位置（一般只有安装位置带有感叹号标记）

       ![配置](/image/配置.PNG)

       ![创建](/image/创建.PNG)

     + 升级 OS 系统内核

       + 获取 wget, yum install wget，过程如下：
       

         ![	yum update](/image/yum instal.PNG)
        ![	yum update](/image/yum install2.PNG)

       + 配置源 163源、阿里云源

         + 升级 OS内核， yum update，升级过程如下：
           						![	yum update](/image/yum update.PNG)

     + 检查网卡配置

       + 在命令行输入配置网络的UI界面 nmtui，弹出蓝色界面，选择第一个选项进行配置第二块网卡地址如下：

         ![网卡配置](/image/网卡配置.PNG)

         其中IP地址为<u>192.168.100.102/24</u>，掩码为<u>255.255.255.0</u>。

       + ping 主机，主机地址为<u>192.168.100.1</u>，使用命令 

         ```
         ping 192.168.100.1
         ```

         结果如下：

         ![ping截图](/image/ping截图.PNG)

     + 退出并关闭虚拟机

       使用如下指令关闭虚拟机

       ```
       poweroff
       ```

       

   + 安装虚拟机

     + 点击 centos-base选择“复制”后弹出界面，需要进行Mac地址的重新生成

       ![复制](/image/复制.PNG)

     + 然后选 链接复制

       ​															![链接复制](/image/链接复制.PNG)

     + 配置主机名和第二块网卡

       + 使用 nmtui 修改主机名和第二块网卡IP地址

         ![第二台虚拟机的网络配置](/image/第二台虚拟机的网络配置.PNG)

       + 重启

       + 在主机上，应能 ping 到这个地址，且能通过 ssh 访问该虚拟机（windows 需启动 git bash）

         ​	经验证，可以在主机上ping到该地址，且能通过ssh访问该虚拟机。

     + 如果你使用 centos 桌面

       + 重新配置虚拟机 CPU，内存，显存

       + 启动虚拟机

       + 使用命令

         ```
         yum groupinstall "GNOME Desktop"
         ```

         安装桌面 

       + 设置启动目标为桌面 

         ```
         ln -sf /lib/systemd/system/runlevel5.target /etc/systemd/system/default.target
         ```

         从网上看到将runlevel5换成runlevel3后可以恢复启动的命令行界面

       + 重启后界面效果如下图：

         ![桌面](/image/桌面.PNG)

       + 在系统中自带Firefox因此没有安装Chrome浏览器。

3. 配置用远程桌面访问你的虚拟机

   ​	远程桌面的链接需要安装拓展包，在官网上下载VirtualBox拓展包(Extension Pack)：	

   ![	拓展包下载](/image/拓展包下载.PNG)

   ​	安装好后需要将拓展包添加在“全局设定”中的“拓展”部分：

   ​												![拓展](/image/拓展.PNG)

   ​	设定好下一步进行远程连接的接口：

   ![端口](F:\大三的文件夹\服务计算\hw\hw1\端口.PNG)

   ​	在win10上打开“开始”菜单，找到windows附件工具，点开“远程桌面连接”，会出现一个选择连接地址和端口的界面，填入设定的地址和接口：

   ​												![ssh远程初始](/image/ssh远程初始.PNG)				

   进行连接后连接成功效果如下图：

   ![远程连接成功](/image/远程连接成功.PNG)

4. 以上一些操作内容适用在本机window 10 环境中安装 CentOS 7 的操作。

## 【实验总结】

​	在文章的最后说一点自己想要说的话，本来是想写在博客里的，搞到现在还是先写在这里作为最后的总结就先不写博客了。

​	认识潘老师是从大一开始的，那时候刚开始接触软导课很多东西都觉得十分的难也不知道怎样利用别人的智慧在网上了解最终实现作业的要求，学习的很辛苦。到了现在大三，对于一些自己没有接触过的课程畏难的心态少多了，去接受去面对去改变的动力多了许多，这些课程都很有用虽然上学期使用过的markdown的语法现在还要使用的时候一遍查阅但是很多学习到的思想却是很有用。

​	这次的实验——“让你的计算机也能提供云桌面服务”本身是一个要求度很低的实验，整个内容要求主要就是通过网卡配置实现使用远程桌面访问，至于virtualBox、虚拟机的安装以及复制虚拟机都难度不大，我在虚拟机第一次复制的时候出现了base虚拟机调整了配置之后也无法再次访问外网的情况，第二次尝试了以后变好了，但是由于情况无法复原我也并没有再深入的思考这个问题。

​	略带遗憾的就是因为这周开学其他事情太多报告没有进行进一步深入思考，在以后的作业完成安排中要尽快完成。

